<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="Easily view today's SMCS blocking schedule for PHS 9th Grade.">
    <title>PHS 9th Grade SMCS Blocking Schedule</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="manifest" href="manifest.json"/>
    <meta name="theme-color" content="#333947"/>
  </head>
  <body>
    <main>
      <div id="content">
        <h1 id="title">PHS 9th Grade SMCS Blocking Schedule</h1>

        <div id="schedule_div">
          <p id="header">Today's Schedule (__/__/__)</p>

          <br>
          <br>

          <table id="schedule_table">
            <tr>
              <th class="table_period">Period</th>
              <th class="table_blockA">Block A</th>
              <th class="table_blockB">Block B</th>
            </tr>

            <tr>
              <td class="table_period">5</td>
              <td class="table_blockA" id="a5">Loading...</td>
              <td class="table_blockB" id="b5">Loading...</td>
            </tr>
            <tr>
              <td class="table_period">6</td>
              <td class="table_blockA" id="a6">Loading...</td>
              <td class="table_blockB" id="b6">Loading...</td>
            </tr>
            <tr>
              <td class="table_period">7</td>
              <td class="table_blockA" id="a7">Loading...</td>
              <td class="table_blockB" id="b7">Loading...</td>
            </tr>
          </table>

          <br>
          <br>

          <p id="footer">Notes: ___________</p>

          </div>
        </div>
      </div>
    </main>

    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register("serviceworker.js");
      }

      // Button Functions
      function refreshSchedule() {

      }

      // Fetch Schedule Data
      fetch("https://smcs-blocking-api.smartynotchy.repl.co/get_data")
        .then((response) => response.json())
        .then((json) => updateSchedule(json.body));

      function updateSchedule(schedule) {
        console.log(schedule);
        document.getElementById("a5").innerHTML = schedule[0][0];
        document.getElementById("b5").innerHTML = schedule[0][1];
        document.getElementById("a6").innerHTML = schedule[1][0];
        document.getElementById("b6").innerHTML = schedule[1][1];
        document.getElementById("a7").innerHTML = schedule[2][0];
        document.getElementById("b7").innerHTML = schedule[2][1];

        if (schedule[3][0] != "" && schedule[3][0] != undefined) {
          document.getElementById("footer").innerHTML = "Notes: " + schedule[3][0];
        } else {
          document.getElementById("footer").innerHTML = "No Extra Notes";
        }

        const date = new Date();
        let weekday = date.getDay();
        if (weekday == 0 || weekday == 6) {
          if (weekday == 6) {
            const nextDate = date.addDays(1);
          }
          const nextDate = date.addDays(1);
          document.getElementById("header").innerHTML = `Monday's Schedule (${nextDate.getMonth()+1}/${nextDate.getDate()}/${nextDate.getFullYear()})`
        } else {
          document.getElementById("header").innerHTML = `Today's Schedule (${date.getMonth()+1}/${date.getDate()}/${date.getFullYear()})`
        }
      }

      
    </script>
  </body>
</html>